{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Modeling Project\"\nauthor: \"SDS348 Fall 2019\"\ndate: \"\"\noutput:\n  pdf_document: default\n  html_document: default\n---\n\n\n\n<div id=\"nina-flores-nmf538\" class=\"section level2\">\n<h2>Nina Flores, nmf538</h2>\n<hr />\n<p>This data comes from a survey that Dr. Fatima Varner’s African American Resilience in Context lab in the Department of Human Development and Family Sciences conducted. The survey has responses from 324 black mothers and 252 black fathers with an adolescent child between 11-18. The survey had over 300 questions targeting various social constructs covering topics of school involvement, parenting behaviors, racial concerns, and racial discrimination. The variables of interest for this project include: ‘PA_EDU’, ‘PART_EDU’, ‘MARSTAT’, ‘TOTIVP’, ‘vicarious’, ‘pdisc’, ‘cdisc’, ‘TOTRCON’, ‘totbpi’, ‘NEIGHCOMP’, ‘JOBCOMP’, ‘SCHCOMP’, ‘TOTINC’, ‘recodedgpa’. ‘PA_EDU’ and ‘PART_EDU’ refer to the parent and partner’s highest level of education received. ‘MARSTAT’ is a parent’s marital status. ‘TOTIVP’ stands for ‘involved-vigilant parenting.’ This section assesses aspects of parents’ behavioral control of their children, and their responsiveness as well. ‘Vicarious’ assesses indirect experiences of discrimination that the parent received. ‘Pdisc’ measures the personal discrimination that the parent experienced and ‘cdisc’ asseses the child’s experiences with racial discrimination. ‘TOTRCON’ is a measure of the racial concerns that a parent has for their child through questions like “How often do you worry your child will get fewer job interviews because of his or her race?” ‘totbpi’ stands for the ‘behavior problem index’ and dives into a child’s tendencies towards depression, anxiety, and peer victimization. ‘NEIGHCOMP,’ ‘JOBCOMP’,and ‘SCHCOMP’ all measure the “blackness of different spaces of the child or parent’s day-to-day experience by asking about the racial compostion and demographics of the neighborhood, work, and school.</p>\n<pre class=\"r\"><code>library(tidyverse)\nlibrary(dbplyr)\nlibrary(MASS)\nlibrary(lmtest)\nlibrary(plotROC)\n\ndata &lt;- read.csv(&quot;~/Downloads/Black parent survey for Nina 2 (1).csv&quot;)\n\n\n# removing the idk category so it doesn&#39;t skew results also\n# removed the ones with 1-3 observations\ndatanoidk &lt;- data %&gt;% filter(Q297 != 8)\ndatano1 &lt;- datanoidk %&gt;% filter(Q297 != 1)\ndatano2 &lt;- datano1 %&gt;% filter(Q297 != 2)\ndatano3 &lt;- datano2 %&gt;% filter(Q297 != 3)\n\n# recode income variable into means for more meaningful\n# interpretations\ndatz &lt;- datano3 %&gt;% mutate(recodedincome = recode(TOTINC, 5000, \n    15000, 25000, 35000, 45000, 55000, 65000, 75000, 85000, 95000, \n    105000, 115000, 125000, 135000, 145000, 155000, .default = NULL, \n    .missing = NULL))\n\n\n\ndatag &lt;- datz %&gt;% filter(Q297 != 1)\ndatagp &lt;- datag %&gt;% filter(Q297 != 2)\ndatagpa &lt;- datagp %&gt;% filter(Q297 != 3)\ndatagpa2 &lt;- datagpa %&gt;% filter(Q297 != 8)\n\n\ndatagpa2 &lt;- datagpa2 %&gt;% mutate(recodedgpa = recode(Q297, 1, \n    1.25, 1.75, 2.25, 2.75, 3.25, 3.75, .default = NULL, .missing = NULL))\nsurveydata &lt;- datagpa2\nsurveydata &lt;- surveydata %&gt;% dplyr::select(PA_GEN, PA_AGE, LIVEWT, \n    CH_GEN, PA_EDU, PART_EDU, MARSTAT, TOTIVP, CRPR_TOT, RAC_SOC, \n    CUL_SOC, MMRI, vicarious, pdisc, cdisc, TOTRCON, Q232, Q233, \n    totbpi, NEIGHCOMP, JOBCOMP, SCHCOMP, recodedincome, recodedgpa, \n    COUNTRY)\n\n\n\n# lets see what these look like\nsurveydata %&gt;% group_by(recodedgpa) %&gt;% drop_na(pdisc, cdisc, \n    TOTIVP, TOTRCON, totbpi, recodedincome, vicarious, RAC_SOC, \n    CUL_SOC, MMRI, ) %&gt;% summarize(n = n(), mean(recodedincome), \n    mean(pdisc), mean(cdisc), mean(TOTIVP), mean(TOTRCON), mean(totbpi)) %&gt;% \n    glimpse()</code></pre>\n<pre><code>## Observations: 4\n## Variables: 8\n## $ recodedgpa            &lt;dbl&gt; 2.25, 2.75, 3.25, 3.75\n## $ n                     &lt;int&gt; 32, 60, 170, 231\n## $ `mean(recodedincome)` &lt;dbl&gt; 54375.00, 65000.00, 67411.76, 73961.04\n## $ `mean(pdisc)`         &lt;dbl&gt; 3.093403, 3.121481, 2.427712, 2.579461\n## $ `mean(cdisc)`         &lt;dbl&gt; 2.764236, 2.581667, 2.104706, 2.100337\n## $ `mean(TOTIVP)`        &lt;dbl&gt; 3.259046, 3.098904, 3.078196, 3.059698\n## $ `mean(TOTRCON)`       &lt;dbl&gt; 2.770833, 2.670076, 2.615553, 2.523864\n## $ `mean(totbpi)`        &lt;dbl&gt; 16.500000, 15.933333, 7.811765, 5.766234</code></pre>\n<p>I was interested in exploring how several variables differ among the children with different grade point averages. Here, the mean income, personal discrimination of the parent, child discrimination, involved vigilant parenting, racial concerns and behavior problem index scores are separated by GPA classifications where the lowest group is from 2-2.5, the next group is 2.5-3, then 3-3.5 and finally 3.5-4.</p>\n</div>\n<div id=\"manova\" class=\"section level1\">\n<h1>Manova</h1>\n<p><em>How does GPA vary among the measures of pdisc, cdisc, vicarious, TOTRCON, TOTIVP, totbpi, recodedincome, RAC_SOC, CUL_SOC, and MMRI?</em><br />\nNull Hypothesis: For the ten measures, means of each GPA grouping are equal. Alternative: For at least one dependent variable, at least one GPA grouping mean is different.</p>\n<p>Before running the manova, I checked the appropriate assumption. Though multivariate normality assumptions and a failed equal variance assumption for cdisc failed, the test was still conducted. These will be limiatations to the results.</p>\n<pre class=\"r\"><code>library(mvnormtest)\n\n# Normality-- fails this assumption.\ncheck &lt;- surveydata %&gt;% dplyr::select(pdisc, cdisc, recodedincome, \n    totbpi, vicarious, TOTRCON, TOTIVP, RAC_SOC, CUL_SOC, MMRI, \n    recodedgpa)\nC &lt;- t(check[1:100, 1:10])\nmshapiro.test(C)</code></pre>\n<pre><code>## \n##  Shapiro-Wilk normality test\n## \n## data:  Z\n## W = 0.87699, p-value = 1.356e-07</code></pre>\n<pre class=\"r\"><code># variance in each of the groups, use .001 since very\n# sensitive test-- cdisc fails.\nbartlett.test(check$cdisc, check$recodedgpa)</code></pre>\n<pre><code>## \n##  Bartlett test of homogeneity of variances\n## \n## data:  check$cdisc and check$recodedgpa\n## Bartlett&#39;s K-squared = 18.003, df = 3, p-value = 0.0004392</code></pre>\n<pre class=\"r\"><code>bartlett.test(check$pdisc, check$recodedgpa)</code></pre>\n<pre><code>## \n##  Bartlett test of homogeneity of variances\n## \n## data:  check$pdisc and check$recodedgpa\n## Bartlett&#39;s K-squared = 12.867, df = 3, p-value = 0.004934</code></pre>\n<pre class=\"r\"><code>bartlett.test(check$recodedincome, check$recodedgpa)</code></pre>\n<pre><code>## \n##  Bartlett test of homogeneity of variances\n## \n## data:  check$recodedincome and check$recodedgpa\n## Bartlett&#39;s K-squared = 0.37069, df = 3, p-value = 0.9462</code></pre>\n<pre class=\"r\"><code>bartlett.test(check$totbpi, check$recodedgpa)</code></pre>\n<pre><code>## \n##  Bartlett test of homogeneity of variances\n## \n## data:  check$totbpi and check$recodedgpa\n## Bartlett&#39;s K-squared = 50.144, df = 3, p-value = 7.446e-11</code></pre>\n<pre class=\"r\"><code>bartlett.test(check$vicarious, check$recodedgpa)</code></pre>\n<pre><code>## \n##  Bartlett test of homogeneity of variances\n## \n## data:  check$vicarious and check$recodedgpa\n## Bartlett&#39;s K-squared = 2.1343, df = 3, p-value = 0.545</code></pre>\n<pre class=\"r\"><code>bartlett.test(check$TOTRCON, check$recodedgpa)</code></pre>\n<pre><code>## \n##  Bartlett test of homogeneity of variances\n## \n## data:  check$TOTRCON and check$recodedgpa\n## Bartlett&#39;s K-squared = 3.4899, df = 3, p-value = 0.3221</code></pre>\n<pre class=\"r\"><code>bartlett.test(check$TOTIVP, check$recodedgpa)</code></pre>\n<pre><code>## \n##  Bartlett test of homogeneity of variances\n## \n## data:  check$TOTIVP and check$recodedgpa\n## Bartlett&#39;s K-squared = 11.889, df = 3, p-value = 0.007773</code></pre>\n<pre class=\"r\"><code>bartlett.test(check$RAC_SOC, check$recodedgpa)</code></pre>\n<pre><code>## \n##  Bartlett test of homogeneity of variances\n## \n## data:  check$RAC_SOC and check$recodedgpa\n## Bartlett&#39;s K-squared = 2.3791, df = 3, p-value = 0.4975</code></pre>\n<pre class=\"r\"><code>bartlett.test(check$CUL_SOC, check$recodedgpa)</code></pre>\n<pre><code>## \n##  Bartlett test of homogeneity of variances\n## \n## data:  check$CUL_SOC and check$recodedgpa\n## Bartlett&#39;s K-squared = 0.53857, df = 3, p-value = 0.9103</code></pre>\n<pre class=\"r\"><code>bartlett.test(check$MMRI, check$recodedgpa)</code></pre>\n<pre><code>## \n##  Bartlett test of homogeneity of variances\n## \n## data:  check$MMRI and check$recodedgpa\n## Bartlett&#39;s K-squared = 5.4398, df = 3, p-value = 0.1423</code></pre>\n<pre class=\"r\"><code># manova\n\n\nman &lt;- manova(cbind(pdisc, cdisc, vicarious, TOTRCON, TOTIVP, \n    totbpi, recodedincome, RAC_SOC, CUL_SOC, MMRI) ~ recodedgpa, \n    data = surveydata)\n\nsummary(man)</code></pre>\n<pre><code>##             Df  Pillai approx F num Df den Df    Pr(&gt;F)    \n## recodedgpa   1 0.18118   10.665     10    482 &lt; 2.2e-16 ***\n## Residuals  491                                             \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>\n<pre class=\"r\"><code>summary.aov(man)</code></pre>\n<pre><code>##  Response pdisc :\n##              Df Sum Sq Mean Sq F value   Pr(&gt;F)   \n## recodedgpa    1  12.54 12.5376  9.3406 0.002363 **\n## Residuals   491 659.05  1.3423                    \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1\n## \n##  Response cdisc :\n##              Df Sum Sq Mean Sq F value    Pr(&gt;F)    \n## recodedgpa    1  17.16 17.1595  13.703 0.0002384 ***\n## Residuals   491 614.87  1.2523                      \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1\n## \n##  Response vicarious :\n##              Df Sum Sq Mean Sq F value Pr(&gt;F)\n## recodedgpa    1   1.31 1.30812  1.6361 0.2015\n## Residuals   491 392.56 0.79951               \n## \n##  Response TOTRCON :\n##              Df Sum Sq Mean Sq F value  Pr(&gt;F)  \n## recodedgpa    1   2.52 2.52000  2.7607 0.09725 .\n## Residuals   491 448.19 0.91282                  \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1\n## \n##  Response TOTIVP :\n##              Df Sum Sq Mean Sq F value  Pr(&gt;F)  \n## recodedgpa    1  0.791 0.79053  6.0662 0.01412 *\n## Residuals   491 63.985 0.13032                  \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1\n## \n##  Response totbpi :\n##              Df Sum Sq Mean Sq F value    Pr(&gt;F)    \n## recodedgpa    1   6303  6302.9  86.041 &lt; 2.2e-16 ***\n## Residuals   491  35968    73.3                      \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1\n## \n##  Response recodedincome :\n##              Df     Sum Sq    Mean Sq F value   Pr(&gt;F)   \n## recodedgpa    1 1.3199e+10 1.3199e+10  6.7385 0.009718 **\n## Residuals   491 9.6171e+11 1.9587e+09                    \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1\n## \n##  Response RAC_SOC :\n##              Df Sum Sq Mean Sq F value  Pr(&gt;F)  \n## recodedgpa    1   3.49  3.4940  4.3717 0.03705 *\n## Residuals   491 392.42  0.7992                  \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1\n## \n##  Response CUL_SOC :\n##              Df Sum Sq Mean Sq F value   Pr(&gt;F)   \n## recodedgpa    1  10.06 10.0554  10.852 0.001058 **\n## Residuals   491 454.94  0.9266                    \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1\n## \n##  Response MMRI :\n##              Df Sum Sq Mean Sq F value  Pr(&gt;F)  \n## recodedgpa    1    3.0  3.0004  4.5371 0.03367 *\n## Residuals   491  324.7  0.6613                  \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1\n## \n## 3 observations deleted due to missingness</code></pre>\n<pre class=\"r\"><code># pdisc, cdisc, TOTIVP, totbpi, income, RAC_SOC, CUL_SOC and\n# MMRI all significant-- post hocs for each\npairwise.t.test(surveydata$pdisc, surveydata$recodedgpa, p.adj = &quot;none&quot;)</code></pre>\n<pre><code>## \n##  Pairwise comparisons using t tests with pooled SD \n## \n## data:  surveydata$pdisc and surveydata$recodedgpa \n## \n##      2.25    2.75    3.25   \n## 2.75 0.91173 -       -      \n## 3.25 0.00396 0.00012 -      \n## 3.75 0.01887 0.00130 0.26257\n## \n## P value adjustment method: none</code></pre>\n<pre class=\"r\"><code>pairwise.t.test(surveydata$cdisc, surveydata$recodedgpa, p.adj = &quot;none&quot;)</code></pre>\n<pre><code>## \n##  Pairwise comparisons using t tests with pooled SD \n## \n## data:  surveydata$cdisc and surveydata$recodedgpa \n## \n##      2.25   2.75   3.25  \n## 2.75 0.4579 -      -     \n## 3.25 0.0028 0.0058 -     \n## 3.75 0.0018 0.0032 0.8961\n## \n## P value adjustment method: none</code></pre>\n<pre class=\"r\"><code>pairwise.t.test(surveydata$TOTIVP, surveydata$recodedgpa, p.adj = &quot;none&quot;)</code></pre>\n<pre><code>## \n##  Pairwise comparisons using t tests with pooled SD \n## \n## data:  surveydata$TOTIVP and surveydata$recodedgpa \n## \n##      2.25   2.75   3.25  \n## 2.75 0.0428 -      -     \n## 3.25 0.0092 0.6955 -     \n## 3.75 0.0033 0.4399 0.5979\n## \n## P value adjustment method: none</code></pre>\n<pre class=\"r\"><code>pairwise.t.test(surveydata$recodedincome, surveydata$recodedgpa, \n    p.adj = &quot;none&quot;)</code></pre>\n<pre><code>## \n##  Pairwise comparisons using t tests with pooled SD \n## \n## data:  surveydata$recodedincome and surveydata$recodedgpa \n## \n##      2.25 2.75 3.25\n## 2.75 0.28 -    -   \n## 3.25 0.10 0.61 -   \n## 3.75 0.02 0.16 0.21\n## \n## P value adjustment method: none</code></pre>\n<pre class=\"r\"><code>pairwise.t.test(surveydata$RAC_SOC, surveydata$recodedgpa, p.adj = &quot;none&quot;)</code></pre>\n<pre><code>## \n##  Pairwise comparisons using t tests with pooled SD \n## \n## data:  surveydata$RAC_SOC and surveydata$recodedgpa \n## \n##      2.25  2.75  3.25 \n## 2.75 0.350 -     -    \n## 3.25 0.093 0.428 -    \n## 3.75 0.043 0.218 0.555\n## \n## P value adjustment method: none</code></pre>\n<pre class=\"r\"><code>pairwise.t.test(surveydata$CUL_SOC, surveydata$recodedgpa, p.adj = &quot;none&quot;)</code></pre>\n<pre><code>## \n##  Pairwise comparisons using t tests with pooled SD \n## \n## data:  surveydata$CUL_SOC and surveydata$recodedgpa \n## \n##      2.25   2.75   3.25  \n## 2.75 0.0790 -      -     \n## 3.25 0.0032 0.2165 -     \n## 3.75 0.0008 0.0841 0.5193\n## \n## P value adjustment method: none</code></pre>\n<pre class=\"r\"><code>pairwise.t.test(surveydata$totbpi, surveydata$recodedgpa, p.adj = &quot;none&quot;)</code></pre>\n<pre><code>## \n##  Pairwise comparisons using t tests with pooled SD \n## \n## data:  surveydata$totbpi and surveydata$recodedgpa \n## \n##      2.25    2.75    3.25 \n## 2.75 0.760   -       -    \n## 3.25 1.3e-07 3.1e-10 -    \n## 3.75 5.7e-11 1.3e-15 0.022\n## \n## P value adjustment method: none</code></pre>\n<pre class=\"r\"><code>pairwise.t.test(surveydata$MMRI, surveydata$recodedgpa, p.adj = &quot;none&quot;)</code></pre>\n<pre><code>## \n##  Pairwise comparisons using t tests with pooled SD \n## \n## data:  surveydata$MMRI and surveydata$recodedgpa \n## \n##      2.25   2.75   3.25  \n## 2.75 0.0753 -      -     \n## 3.25 0.0056 0.3307 -     \n## 3.75 0.0080 0.4403 0.7347\n## \n## P value adjustment method: none</code></pre>\n<pre class=\"r\"><code># Calculate number of tests run: 1 manova, 10 anovas, each\n# pairwise test runs 6, so 8*6 = 48, so 48+10+1 = 59 tests\n# total\n\n# chance of type 1 error\n1 - ((0.95)^59)</code></pre>\n<pre><code>## [1] 0.9515055</code></pre>\n<pre class=\"r\"><code># So we must use correction\n0.05/59  #new alpha</code></pre>\n<pre><code>## [1] 0.0008474576</code></pre>\n<p>In order to test whether the mean income, personal discrimination of the parent, child discrimination, vicarious discrimination, involved vigilant parenting, racial concerns, racial socialization scores, cultural socialization scores, racial identity score, and behavior problem index scores differ across GPA categories, I ran a multivariate analysis of variance, or MANOVA. The MANOVA found that these groups did significantly differ on the 10 measures (Pillai trace = 0.18118, F(1,491)= 10.665, p&lt; 2.2e-16). Univariate analyses of variance (ANOVAs) for each dependent variable were conducted as follow-up tests to the MANOVA, and using the Bonferroni method for controlling the Type I error, the univariate ANOVA for problem behaviors (F(1,491)= 86.041, p &lt; 2.2e-16)) and child discrimination (F(1,491)= 13.703, p= 0.0002384)) were significant.</p>\n<p>Post hoc analysis was performed, conducting pairwise comparisons to determine which GPA groups differed in ‘totbpi’, and ‘cdisc’. After adjusting for multiple comparisons (bonferroni), due to the type 1 error rate of 0.9515055, the total bpi still significantly differed between the 2.0- 2.5 group to the 3.0-3.5 and 3.5-4.0 groups and the 2.5-3.0 group significantly differed from the 3.0-3.5 and 3.5-4.0 groups as well.</p>\n<pre class=\"r\"><code>check %&gt;% ggplot(aes(recodedgpa, totbpi, fill = recodedgpa)) + \n    geom_bar(stat = &quot;summary&quot;) + geom_errorbar(stat = &quot;summary&quot;) + \n    coord_flip() + ylab(&quot;total bpi score&quot;) + theme(legend.position = &quot;none&quot;)</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-4-1.png\" width=\"768\" style=\"display: block; margin: auto;\" /></p>\n<pre class=\"r\"><code>check %&gt;% ggplot(aes(recodedgpa, cdisc, fill = recodedgpa)) + \n    geom_bar(stat = &quot;summary&quot;) + geom_errorbar(stat = &quot;summary&quot;) + \n    coord_flip() + ylab(&quot;Child Discrimination Score (1-5)&quot;) + \n    xlab(&quot;GPA Group&quot;) + theme(legend.position = &quot;none&quot;) + ggtitle(&quot;Child Discrimination Score by GPA Grouping&quot;)</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-4-2.png\" width=\"768\" style=\"display: block; margin: auto;\" /></p>\n<p>The first graph illustrates the differences in bpi among the different GPA groupings, and the second illustates the difference in cdisc among the groupings. Limitations to these results include failed multivariate normality assumptions and a failed equal variance assumption for cdisc. #Randomization Test<br />\n<em>Do mothers or fathers experience more racial discrimination?</em></p>\n<pre class=\"r\"><code># Male = 1, Female = 2\nMother &lt;- surveydata %&gt;% filter(PA_GEN == 2)\nFather &lt;- surveydata %&gt;% filter(PA_GEN == 1)\n\n\nhist(Mother$pdisc)</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-5-1.png\" width=\"768\" style=\"display: block; margin: auto;\" /></p>\n<pre class=\"r\"><code>hist(Father$pdisc)</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-5-2.png\" width=\"768\" style=\"display: block; margin: auto;\" /></p>\n<pre class=\"r\"><code># the group difference\n\n\nmean(Mother$pdisc, na.rm = T) - mean(Father$pdisc, na.rm = T)</code></pre>\n<pre><code>## [1] -0.2481328</code></pre>\n<pre class=\"r\"><code>surveydataMF &lt;- surveydata %&gt;% drop_na(pdisc)\n\n# randomization!\nset.seed(348)\nrand_distribution &lt;- vector()\nfor (i in 1:5000) {\n    new &lt;- data.frame(pdisc = sample(surveydataMF$pdisc), gender = surveydataMF$PA_GEN)\n    rand_distribution[i] &lt;- mean(new[new$gender == &quot;2&quot;, ]$pdisc) - \n        mean(new[new$gender == &quot;1&quot;, ]$pdisc)\n}\n\n# create the histogram of the distribution with our test\n# statistic\n{\n    hist(rand_distribution, main = &quot;Random Distribution of Parent Discrimination&quot;, \n        ylab = &quot;Count&quot;)\n    abline(v = -0.2335992, col = &quot;red&quot;)\n}</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-5-3.png\" width=\"768\" style=\"display: block; margin: auto;\" /></p>\n<pre class=\"r\"><code>mean(rand_distribution &gt; abs(-0.2335992)) * 2  #pvalue &lt; alpha, significant</code></pre>\n<pre><code>## [1] 0.0272</code></pre>\n<pre class=\"r\"><code># comparison to ttest\nt.test(pdisc ~ PA_GEN, data = surveydata)</code></pre>\n<pre><code>## \n##  Welch Two Sample t-test\n## \n## data:  pdisc by PA_GEN\n## t = 2.3326, df = 466.75, p-value = 0.02009\n## alternative hypothesis: true difference in means is not equal to 0\n## 95 percent confidence interval:\n##  0.03909937 0.45716619\n## sample estimates:\n## mean in group 1 mean in group 2 \n##        2.765894        2.517761</code></pre>\n<p>Null Hypothesis: There is no difference in the average rate of personal discrimination based on gender. Alternative Hypothesis: Mothers and fathers receive different amounts of personal discrimination on average. Assumptions for the independent t-test were violated, so we use randomization. The actual mean difference between the groups was found to be -0.2335992 (when subtracting fathers from mothers). After running the randomization test, a p-value of.0308 was found and can be visualized by the two red lines on the distibution above. Since the p-value is less than our alpha of .05, we can conclude that there is a significant difference in the amount of personal discrimination that mothers and fathers face. Fathers face significantly more discrimination when compared to mothers.</p>\n</div>\n<div id=\"linear-regression-modeling-the-effects-of-discrimination-and-school-composition-on-the-problem-behaviors-index\" class=\"section level1\">\n<h1>Linear Regression Modeling the Effects of Discrimination and School Composition on the Problem Behaviors Index</h1>\n<pre class=\"r\"><code>surveydata &lt;- surveydata\nsurveydata$SCHCOMP &lt;- factor(surveydata$SCHCOMP)\nsurveydata$cdisc_centered = surveydata$cdisc - mean(surveydata$cdisc, \n    na.rm = T)\n\nsurveydata &lt;- surveydata %&gt;% filter(SCHCOMP != 6)\n\nfitbpi &lt;- lm(totbpi ~ cdisc_centered * SCHCOMP, data = surveydata)\nsummary(fitbpi)</code></pre>\n<pre><code>## \n## Call:\n## lm(formula = totbpi ~ cdisc_centered * SCHCOMP, data = surveydata)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -20.646  -4.856  -1.758   4.147  27.883 \n## \n## Coefficients:\n##                         Estimate Std. Error t value Pr(&gt;|t|)    \n## (Intercept)              12.3032     1.0738  11.458  &lt; 2e-16 ***\n## cdisc_centered            5.5176     0.9842   5.606  3.5e-08 ***\n## SCHCOMP2                 -3.7842     1.3877  -2.727 0.006625 ** \n## SCHCOMP3                 -4.3260     1.2304  -3.516 0.000480 ***\n## SCHCOMP4                 -4.7530     1.2433  -3.823 0.000149 ***\n## SCHCOMP5                 -5.5801     1.9309  -2.890 0.004029 ** \n## cdisc_centered:SCHCOMP2  -0.4654     1.1755  -0.396 0.692320    \n## cdisc_centered:SCHCOMP3  -1.7135     1.1269  -1.521 0.129015    \n## cdisc_centered:SCHCOMP4  -3.2847     1.1556  -2.842 0.004669 ** \n## cdisc_centered:SCHCOMP5  -1.2822     1.8684  -0.686 0.492895    \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1\n## \n## Residual standard error: 7.854 on 479 degrees of freedom\n##   (2 observations deleted due to missingness)\n## Multiple R-squared:  0.2691, Adjusted R-squared:  0.2554 \n## F-statistic:  19.6 on 9 and 479 DF,  p-value: &lt; 2.2e-16</code></pre>\n<pre class=\"r\"><code># Confirm linearity of numeric predictors\nsurveydata %&gt;% ggplot(aes(cdisc_centered, totbpi)) + geom_point()</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-6-1.png\" width=\"768\" style=\"display: block; margin: auto;\" /></p>\n<pre class=\"r\"><code># Confirm normality of residuals\nhist(fitbpi$residuals, main = &quot;Model Residuals&quot;, xlab = &quot;Residual&quot;, \n    col = &quot;light grey&quot;, right = F)</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-6-2.png\" width=\"768\" style=\"display: block; margin: auto;\" /></p>\n<pre class=\"r\"><code># Confirm equal variance, seems to be fanning out\nplot(fitbpi$fitted.values, fitbpi$residuals, xlab = &quot;Fitted Values&quot;, \n    ylab = &quot;Residuals&quot;, main = &quot;Residual Plot&quot;, pch = 20)\nabline(h = 0, col = &quot;red&quot;)</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-6-3.png\" width=\"768\" style=\"display: block; margin: auto;\" /></p>\n<p>I was interested in what variables contribute to the scores of the behavior problem index in children. I created a linear regression model to see how much variation in bpi can be explained by the child’s school’s racial composition, as well as their exposure to discrimination. For a black child who receives an average amount of discrimination at a school that is almost all black, their estimated score for the behavior problem index is 12.3032. While holding school composition constant, the score on the bpi increases by 5.5176 for every 1 unit increase of discrimination the child receives. The school composition variable is on a scale of 1-5 where a score of 1 means the school is mostly black while 5 means the school is hardly black. With this scale in mind, while holding discrimination constant, a school that is mostly black has a decrease in bpi of 3.7842. While holding discrimination constant, a school that is about half black has a decrease in bpi of 4.3260. While holding discrimination constant, a school that has a few other black children has a decrease in bpi of 4.7530. Finally, while holding discrimination constant, a school that has almost no other black children has the largest decrease in bpi of at 5.5801. There is -3.2847 is a difference in slopes for the 4th category of school composition and cdisc. The interactions with each dependent variable on the x-axis are provided in order to help visualize these coefficients. This data however failed the linearity and equal variance assumptions, which is a limitation that will be adjusted for on future steps. This model explains 25.2% of the difference in total bpi. Therefore, discrimination and school composition do contribute to bpi scores, but there is still a large amount of the variation unaccounted for by this model.</p>\n<pre class=\"r\"><code>fitbpi %&gt;% ggplot(aes(cdisc_centered, totbpi)) + geom_smooth(method = &quot;lm&quot;, \n    aes(color = SCHCOMP), se = F) + ggtitle(&quot;Total Behavior Problem Index Score vs. Child Discrimination&quot;) + \n    labs(color = &quot;School Composition&quot;) + ylab(&quot;Total Behavior Problem Index Score&quot;) + \n    xlab(&quot;Child Discrimination (centered)&quot;)</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-7-1.png\" width=\"768\" style=\"display: block; margin: auto;\" /></p>\n<p>In this plot, a school composition that was almost all black (1) is shown with the red line, a school that was mostly black (2) was shown by the yellow line, a school that was about half black (3) was shown in green, a school that has a few black students (4) was shown in blue, and a school with close to no other black students (5) is shown in purple. The graph illustrates that at every school, children who were exposed to more discrimination were likely to have a higher score for bpi. This plot also shows that as the schools become less black, the students likely have lower scores on the total behavior problem index. This was the opposite of what I originally expected to see, because I hypothesized that for the black students, a school with a greater number of people who look like them would have a postive impact on their bpi. This opposite effect is likely due to another variable we are not looking into, such as the school’s resources, which may be benefitting the black children even at a school where they are in the minority.</p>\n<pre class=\"r\"><code>library(sandwich)\nfitbpi %&gt;% ggplot(aes(cdisc_centered, totbpi)) + geom_point() + \n    geom_smooth(method = &quot;lm&quot;, se = F) + ggtitle(&quot;Total Behavior Problem Index Score vs. Child Discrimination&quot;) + \n    ylab(&quot;Total Behavior Problem Index Score&quot;) + xlab(&quot;Child Discrimination (centered)&quot;)</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-8-1.png\" width=\"768\" style=\"display: block; margin: auto;\" /></p>\n<pre class=\"r\"><code># seems to be fanning out\n\n\nbptest(fitbpi)  #fails homoskedasity, need to recompute with robust errors</code></pre>\n<pre><code>## \n##  studentized Breusch-Pagan test\n## \n## data:  fitbpi\n## BP = 67.388, df = 9, p-value = 4.941e-11</code></pre>\n<pre class=\"r\"><code>coeftest(fitbpi, vcov = vcovHC(fitbpi))</code></pre>\n<pre><code>## \n## t test of coefficients:\n## \n##                         Estimate Std. Error t value  Pr(&gt;|t|)    \n## (Intercept)             12.30319    1.19911 10.2603 &lt; 2.2e-16 ***\n## cdisc_centered           5.51759    1.14579  4.8155 1.972e-06 ***\n## SCHCOMP2                -3.78423    1.45215 -2.6059 0.0094475 ** \n## SCHCOMP3                -4.32595    1.35806 -3.1854 0.0015399 ** \n## SCHCOMP4                -4.75298    1.34639 -3.5302 0.0004554 ***\n## SCHCOMP5                -5.58011    1.78266 -3.1302 0.0018535 ** \n## cdisc_centered:SCHCOMP2 -0.46544    1.56654 -0.2971 0.7665061    \n## cdisc_centered:SCHCOMP3 -1.71352    1.36519 -1.2552 0.2100336    \n## cdisc_centered:SCHCOMP4 -3.28474    1.35724 -2.4202 0.0158849 *  \n## cdisc_centered:SCHCOMP5 -1.28216    2.94988 -0.4346 0.6640128    \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>\n<p>This is a plot of the regression with bpi on the y axis and cdisc on the x axis. There does seem to be some fanning out occuring, and therefore failing the homoskedasticity assumption. After running the Breusch-Pagan Test, it was confirmed that the homoskedasticity assumption was failed with a p value of 4.941e-11. The test was then re-run with robust standard errors. All of the same coeffieicents are still significant as above before the correction.</p>\n<pre class=\"r\"><code># Compute bootstrapped SE\ncdisc_centered &lt;- surveydata$cdisc_centered\nSCHCOMP &lt;- surveydata$SCHCOMP\ntotbpi &lt;- surveydata$totbpi\n\nsurveydatab &lt;- cbind.data.frame(cdisc_centered, SCHCOMP, totbpi)\nsurveydatab &lt;- surveydatab %&gt;% na.omit()\n\nsamp_distn &lt;- replicate(5000, {\n    data_strapped &lt;- surveydatab[sample(nrow(surveydatab), replace = TRUE), \n        ]\n    fitboot &lt;- lm(totbpi ~ cdisc_centered * SCHCOMP, data = data_strapped)\n    coef(fitboot)\n})\n## Estimated SEs\n\nsamp_distn %&gt;% t %&gt;% as.data.frame %&gt;% summarize_all(sd)</code></pre>\n<pre><code>##   (Intercept) cdisc_centered SCHCOMP2 SCHCOMP3 SCHCOMP4 SCHCOMP5\n## 1    1.170441       1.108424 1.424488 1.323783 1.318234 1.687867\n##   cdisc_centered:SCHCOMP2 cdisc_centered:SCHCOMP3 cdisc_centered:SCHCOMP4\n## 1                1.481987                1.313802                1.305539\n##   cdisc_centered:SCHCOMP5\n## 1                2.526041</code></pre>\n<p>The bootstrapped standard errors are almost identical to, but slightly smaller than those from both tests above.</p>\n</div>\n<div id=\"logistic-regression-modeling-the-effects-of-discrimination-and-school-composition-on-the-problem-behaviors-index\" class=\"section level1\">\n<h1>Logistic Regression Modeling the Effects of Discrimination and School Composition on the Problem Behaviors Index</h1>\n<pre class=\"r\"><code>surveydata$SCHCOMP &lt;- factor(surveydata$SCHCOMP)\nsurveydata$MARSTAT &lt;- factor(surveydata$MARSTAT)\n\nsurveydata &lt;- surveydata %&gt;% drop_na(totbpi)\nsurveybpi &lt;- surveydata %&gt;% mutate(totbpi = ifelse(totbpi &gt;= \n    mean(totbpi), 1, 0))\nsurveybpi &lt;- surveybpi %&gt;% drop_na(recodedgpa, cdisc_centered, \n    SCHCOMP, MARSTAT)\n\nfitbpi &lt;- glm(totbpi ~ recodedgpa + cdisc_centered + SCHCOMP + \n    MARSTAT, data = surveybpi, family = &quot;binomial&quot;)\ncoeftest(fitbpi)</code></pre>\n<pre><code>## \n## z test of coefficients:\n## \n##                 Estimate Std. Error z value  Pr(&gt;|z|)    \n## (Intercept)     5.329291   0.901218  5.9134 3.350e-09 ***\n## recodedgpa     -1.568980   0.255095 -6.1506 7.721e-10 ***\n## cdisc_centered  0.599083   0.099808  6.0023 1.945e-09 ***\n## SCHCOMP2       -0.737097   0.407160 -1.8103  0.070243 .  \n## SCHCOMP3       -0.996240   0.362601 -2.7475  0.006005 ** \n## SCHCOMP4       -0.751779   0.363398 -2.0687  0.038570 *  \n## SCHCOMP5       -1.251208   0.605629 -2.0660  0.038832 *  \n## MARSTAT2        0.166883   0.258096  0.6466  0.517896    \n## MARSTAT3       -0.233209   0.398985 -0.5845  0.558881    \n## MARSTAT4       -0.859369   0.688158 -1.2488  0.211739    \n## MARSTAT5       -0.654860   1.122903 -0.5832  0.559769    \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>\n<pre class=\"r\"><code>exp(coef(fitbpi))</code></pre>\n<pre><code>##    (Intercept)     recodedgpa cdisc_centered       SCHCOMP2       SCHCOMP3 \n##    206.2916601      0.2082576      1.8204486      0.4785009      0.3692654 \n##       SCHCOMP4       SCHCOMP5       MARSTAT2       MARSTAT3       MARSTAT4 \n##      0.4715272      0.2861590      1.1816158      0.7919884      0.4234290 \n##       MARSTAT5 \n##      0.5195146</code></pre>\n<p>In order to run a logistic regression, I created a binary variable from the totbpi variable by categorizing scores as either above or below the mean. With this new variable, I wanted to model that probability that a student would have a higher than average, or lower than average bpi score. With this model, I attempt to predict a student’s bpi catergorization using their gpa, their exposure to discrimination, their school’s composition, and their parents marital status. The intercept is the odds of a student having a higher than average bpi with a gpa of 0, a cdisc of 0, a school that is all black and parents that have never been married. Holding cdisc, school compostion, and parent’s marital status constant, one-unit increase in gpa multiplies the odds of having a higher than average bpi score by a factor of 0.2082576. Holding gpa, school compostion, and parent’s marital status constant, one-unit increase in a child’s discrimination score multiplies the odds of having a higher than average bpi score by a factor of 1.8204486. Holding cdisc, school gpa, and parent’s marital status constant, having a school that is about half black multiplies the odds of having a higher than average bpi score by a factor of .3692654. Holding cdisc, school gpa, and parent’s marital status constant, having a school that has a few other black students multiplies the odds of having a higher than average bpi score by a factor of .4715272. Holding cdisc, school gpa, and parent’s marital status constant, having a school that has almost no other black students multiplies the odds of having a higher than average bpi score by a factor of .2861590.</p>\n<pre class=\"r\"><code>class_diag &lt;- function(probs, truth) {\n    \n    tab &lt;- table(factor(probs &gt; 0.5, levels = c(&quot;FALSE&quot;, &quot;TRUE&quot;)), \n        truth)\n    acc = sum(diag(tab))/sum(tab)\n    sens = tab[2, 2]/colSums(tab)[2]\n    spec = tab[1, 1]/colSums(tab)[1]\n    ppv = tab[2, 2]/rowSums(tab)[2]\n    \n    if (is.numeric(truth) == FALSE &amp; is.logical(truth) == FALSE) \n        truth &lt;- as.numeric(truth) - 1\n    \n    # CALCULATE EXACT AUC\n    ord &lt;- order(probs, decreasing = TRUE)\n    probs &lt;- probs[ord]\n    truth &lt;- truth[ord]\n    \n    TPR = cumsum(truth)/max(1, sum(truth))\n    FPR = cumsum(!truth)/max(1, sum(!truth))\n    \n    dup &lt;- c(probs[-1] &gt;= probs[-length(probs)], FALSE)\n    TPR &lt;- c(0, TPR[!dup], 1)\n    FPR &lt;- c(0, FPR[!dup], 1)\n    \n    n &lt;- length(TPR)\n    auc &lt;- sum(((TPR[-1] + TPR[-n])/2) * (FPR[-1] - FPR[-n]))\n    \n    data.frame(acc, sens, spec, ppv, auc)\n}\n\n\nsurveybpi$prob &lt;- predict(fitbpi, type = &quot;response&quot;)\ntable(predict = as.numeric(surveybpi$prob &gt; 0.5), truth = surveybpi$totbpi) %&gt;% \n    addmargins</code></pre>\n<pre><code>##        truth\n## predict   0   1 Sum\n##     0   275  98 373\n##     1    39  76 115\n##     Sum 314 174 488</code></pre>\n<pre class=\"r\"><code>class_diag(surveybpi$prob, truth = surveybpi$totbpi)</code></pre>\n<pre><code>##         acc      sens      spec       ppv       auc\n## 1 0.7192623 0.4367816 0.8757962 0.6608696 0.7630225</code></pre>\n<p>The confusion matrix shows that the model does a better job of classifying negatives than positives. This is confirmed by the high specificity, or true negative rate given as 0.8757962. The sensitivity, or true positive rate is much lower at 0.4367816. The accuracy of this model is 0.7192623. The positive predictive value, or precison is 0.6608696 and the area under the curve (AUC) is 0.7630225. The AUC represents the probability that a randomly selected child with a higher than average bpi score has a higher prediction than a randomly selected child with a lower than average bpi score. So, 0.7630225 is a pretty decent AUC.</p>\n<pre class=\"r\"><code>logit &lt;- predict(fitbpi, response = &quot;logit&quot;)\n\nsurveybpi &lt;- surveybpi %&gt;% drop_na(totbpi)\nsurveybpi$BPI_Category &lt;- ifelse(surveybpi$totbpi &gt; mean(surveybpi$totbpi), \n    &quot;above mean&quot;, &quot;below mean&quot;)\n\n\nggplot(surveybpi, aes(x = logit, fill = BPI_Category)) + geom_density(alpha = 0.75) + \n    ggtitle(&quot;Prediction Model&quot;)</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-12-1.png\" width=\"768\" style=\"display: block; margin: auto;\" /> This graph is a visualization of what the model is predicting in each category. Everything that is being predicted as above the mean is shown in pink. Everything being categorized as below the mean is shown in blue. Everything in grey has been miscategorized. To the right of 0, gray is proportion of below the mean that we predicted above it (false positives). To the left of 0, gray is proportion of above the mean that we predicted below it (false negatives).</p>\n<pre class=\"r\"><code>ROCplot &lt;- ggplot(surveybpi) + geom_roc(aes(d = totbpi, m = prob), \n    n.cuts = 0) + ggtitle(&quot;Receiver Operating Characteristic Curve&quot;)\nROCplot</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-13-1.png\" width=\"768\" style=\"display: block; margin: auto;\" /></p>\n<pre class=\"r\"><code>calc_auc(ROCplot)</code></pre>\n<pre><code>##   PANEL group       AUC\n## 1     1    -1 0.7630225</code></pre>\n<p>This graph is the ROC (receiver operating characteristic) curve of our model. The area under the curve (AUC) of 0.7630225 quantifies how well the model is predicting overall. Since ours is found in the range of .7-.8, it is doing a fair job.</p>\n</div>\n<div id=\"cross-validation-on-model-of-the-effects-of-discrimination-and-school-composition-on-the-problem-behaviors-index\" class=\"section level1\">\n<h1>Cross Validation on Model of the Effects of Discrimination and School Composition on the Problem Behaviors Index</h1>\n<pre class=\"r\"><code>set.seed(1234)\nk = 10\n\ndata1 &lt;- surveybpi[sample(nrow(surveybpi)), ]  #randomly order rows\nfolds &lt;- cut(seq(1:nrow(surveybpi)), breaks = k, labels = F)  #create folds\n\ndiags &lt;- NULL\nfor (i in 1:k) {\n    ## Create training and test sets\n    train &lt;- data1[folds != i, ]\n    test &lt;- data1[folds == i, ]\n    truth &lt;- test$totbpi\n    \n    ## Train model on training set\n    fit &lt;- glm(totbpi ~ recodedgpa + cdisc_centered + SCHCOMP + \n        MARSTAT, data = train, family = &quot;binomial&quot;)\n    probs &lt;- predict(fit, newdata = test, type = &quot;response&quot;)\n    ## Test model on test set (save all k results)\n    diags &lt;- rbind(diags, class_diag(probs, truth))\n}\n\n\napply(diags, 2, mean)  #average across all k results</code></pre>\n<pre><code>##       acc      sens      spec       ppv       auc \n## 0.7192177 0.4476838 0.8770594 0.6569188 0.7438930</code></pre>\n<p>A 10-fold cross validation was performed to test model’s ability to predict new data that was not used to estimate it. The values are very similar to those before, but are slightly more conservative. The accuracy is now 0.7192177 , the sensitivity is 0.4476838, the specificity is 0.8770594, the precision is 0.6569188, and the AUC is 0.7438930. The AUC is slightly lower with the new data, but it is still very similar to the in-sample data. So, a child’s school composition and experiences of discrimination are decent predictors of their bpi.</p>\n</div>\n<div id=\"lasso-regression-on-the-problem-behaviors-index\" class=\"section level1\">\n<h1>Lasso Regression on the Problem Behaviors Index</h1>\n<pre class=\"r\"><code>library(glmnet)\nsurveydata$SCHCOMP &lt;- factor(surveydata$SCHCOMP)\nsurveydata$MARSTAT &lt;- factor(surveydata$MARSTAT)\nsurveydata$PA_EDU &lt;- factor(surveydata$PA_EDU)\nsurveydata$PART_EDU &lt;- factor(surveydata$PART_EDU)\nsurveydata$NEIGHCOMP &lt;- factor(surveydata$NEIGHCOMP)\nsurveydata$JOBCOMP &lt;- factor(surveydata$JOBCOMP)\nsurveydata$LIVEWT &lt;- factor(surveydata$LIVEWT)\nsurveydata$CH_GEN &lt;- factor(surveydata$CH_GEN)\n\n\nsurveydata &lt;- surveydata %&gt;% drop_na(totbpi)\nsurveybpi &lt;- surveydata %&gt;% mutate(totbpi = ifelse(totbpi &gt;= \n    mean(totbpi), 1, 0))\nsurveybpi &lt;- surveybpi %&gt;% drop_na(PA_AGE, LIVEWT, CH_GEN, PA_EDU, \n    PART_EDU, MARSTAT, TOTIVP, CRPR_TOT, RAC_SOC, CUL_SOC, MMRI, \n    vicarious, pdisc, cdisc, TOTRCON, Q232, Q233, totbpi, recodedgpa, \n    NEIGHCOMP, JOBCOMP, SCHCOMP, recodedincome, COUNTRY, cdisc_centered)\n\nsurveybpi &lt;- surveybpi %&gt;% dplyr::select(-cdisc)\n\nset.seed(1234)\n\nfiteverything &lt;- glm(totbpi ~ ., data = surveybpi, family = &quot;binomial&quot;)\ny &lt;- as.matrix(surveybpi$totbpi)  ###save response variable \nx &lt;- model.matrix(fiteverything)  ###save matrix of all predictors (dropping the response variable)\nx &lt;- x[, -1]\n\ncv &lt;- cv.glmnet(x, y, family = &quot;binomial&quot;)\nlasso &lt;- glmnet(x, y, family = &quot;binomial&quot;, lambda = cv$lambda.1se)\ncoef(lasso)</code></pre>\n<pre><code>## 54 x 1 sparse Matrix of class &quot;dgCMatrix&quot;\n##                         s0\n## (Intercept)     2.96431079\n## PA_GEN          .         \n## PA_AGE          .         \n## LIVEWT2         .         \n## LIVEWT3         .         \n## CH_GEN2         .         \n## CH_GEN3         .         \n## PA_EDU2         .         \n## PA_EDU3         .         \n## PA_EDU4         .         \n## PA_EDU5         .         \n## PA_EDU6         .         \n## PA_EDU7         .         \n## PA_EDU8         .         \n## PA_EDU9         .         \n## PART_EDU2       .         \n## PART_EDU3       .         \n## PART_EDU4       .         \n## PART_EDU5       .         \n## PART_EDU6       .         \n## PART_EDU7       .         \n## PART_EDU8       .         \n## PART_EDU9       .         \n## MARSTAT2        .         \n## MARSTAT3        .         \n## MARSTAT4        .         \n## MARSTAT5        .         \n## TOTIVP          .         \n## CRPR_TOT        .         \n## RAC_SOC         .         \n## CUL_SOC         .         \n## MMRI           -0.19744881\n## vicarious       .         \n## pdisc           0.03095143\n## TOTRCON         .         \n## Q232            .         \n## Q233            .         \n## NEIGHCOMP2      .         \n## NEIGHCOMP3      .         \n## NEIGHCOMP4      .         \n## NEIGHCOMP5      .         \n## JOBCOMP2        .         \n## JOBCOMP3        .         \n## JOBCOMP4        .         \n## JOBCOMP5        .         \n## JOBCOMP6        .         \n## SCHCOMP2        .         \n## SCHCOMP3        .         \n## SCHCOMP4        .         \n## SCHCOMP5        .         \n## recodedincome   .         \n## recodedgpa     -0.78564297\n## COUNTRY         .         \n## cdisc_centered  0.25639416</code></pre>\n<pre class=\"r\"><code># plug in only what was significant\nsurveylasso &lt;- surveybpi\nsurveylasso$PART_EDU4 &lt;- ifelse(surveylasso$PART_EDU == &quot;4&quot;, \n    1, 0)\n\nset.seed(1234)\nk = 10\n\ndata1 &lt;- surveylasso[sample(nrow(surveylasso)), ]  #randomly order rows\nfolds &lt;- cut(seq(1:nrow(surveylasso)), breaks = k, labels = F)  #create folds\n\ndiags &lt;- NULL\nfor (i in 1:k) {\n    ## Create training and test sets\n    train &lt;- data1[folds != i, ]\n    test &lt;- data1[folds == i, ]\n    truth &lt;- test$totbpi\n    \n    ## Train model on training set\n    fit &lt;- glm(totbpi ~ PART_EDU4 + MMRI + pdisc + cdisc_centered + \n        recodedgpa, data = train, family = &quot;binomial&quot;)\n    probs &lt;- predict(fit, newdata = test, type = &quot;response&quot;)\n    ## Test model on test set (save all k results)\n    diags &lt;- rbind(diags, class_diag(probs, truth))\n}\n\n\napply(diags, 2, mean)  #average across all k results</code></pre>\n<pre><code>##       acc      sens      spec       ppv       auc \n## 0.7475610 0.5417262 0.8697802 0.6909499 0.7928296</code></pre>\n<p>After running a lasso-regression, the coefficients that are non-zero for predicting whether a person has higher or lower than average bpi score are PART_EDU4 (partner’s highest education level is some college), MMRI (racial identity score), pdisc, cdisc_centered, and recodedgpa. Plugging in these variables into a cross validation improves the results of our model, and it is doing a pretty good job of predicting which bpi category a child falls in. The accuracy is 0.7475610, sensitivity (true positive rate) is 0.5417262, specificity (true negative rate) is 0.8697802, precision (postitive predictive value) is 0.6909499 and the area under the curve is 0.7928296.</p>\n</div>\n<div id=\"linear-regression-modeling-of-the-effects-of-the-highest-level-of-education-received-by-each-parent-on-total-household-income\" class=\"section level1\">\n<h1>Linear Regression Modeling of the Effects of the Highest Level of Education Received by Each Parent on Total Household Income</h1>\n<pre class=\"r\"><code>surveydata$pdisc_centered = surveydata$pdisc - mean(surveydata$pdisc, \n    na.rm = T)\n\n\nIncome &lt;- surveydata %&gt;% mutate(recodedincome = ifelse(recodedincome &gt;= \n    mean(recodedincome), 1, 0))\nIncome &lt;- Income %&gt;% drop_na(PA_EDU, PA_GEN, pdisc_centered, \n    recodedincome, vicarious, PART_EDU)\nIncome$PA_EDU &lt;- factor(Income$PA_EDU)\nIncome$PA_GEN &lt;- factor(Income$PA_GEN)\n\nfitinc &lt;- glm(recodedincome ~ PA_EDU + PART_EDU, data = Income, \n    family = &quot;binomial&quot;)\ncoeftest(fitinc)</code></pre>\n<pre><code>## \n## z test of coefficients:\n## \n##              Estimate Std. Error z value Pr(&gt;|z|)  \n## (Intercept) -15.84062  636.10064 -0.0249  0.98013  \n## PA_EDU2       0.62177    0.95033  0.6543  0.51294  \n## PA_EDU3      -0.15634    0.92311 -0.1694  0.86551  \n## PA_EDU4      -0.30907    0.85020 -0.3635  0.71621  \n## PA_EDU5       0.12376    0.85009  0.1456  0.88425  \n## PA_EDU6       0.77047    0.83014  0.9281  0.35334  \n## PA_EDU7       1.71808    1.01360  1.6950  0.09007 .\n## PA_EDU8       1.02542    0.85801  1.1951  0.23205  \n## PA_EDU9       2.89659    1.13697  2.5476  0.01085 *\n## PART_EDU2    13.51657  636.10062  0.0212  0.98305  \n## PART_EDU3    14.46330  636.10036  0.0227  0.98186  \n## PART_EDU4    14.65536  636.10031  0.0230  0.98162  \n## PART_EDU5    14.54057  636.10035  0.0229  0.98176  \n## PART_EDU6    15.43116  636.10030  0.0243  0.98065  \n## PART_EDU7    17.09018  636.10074  0.0269  0.97857  \n## PART_EDU8    16.54569  636.10038  0.0260  0.97925  \n## PART_EDU9    15.58258  636.10092  0.0245  0.98046  \n## ---\n## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>\n<pre class=\"r\"><code>exp(coeftest(fitinc))</code></pre>\n<pre><code>## \n## z test of coefficients:\n## \n##                Estimate  Std. Error z value Pr(&gt;|z|)\n## (Intercept)  1.3198e-07 1.7989e+276  0.9754    2.665\n## PA_EDU2      1.8622e+00  2.5866e+00  1.9237    1.670\n## PA_EDU3      8.5527e-01  2.5171e+00  0.8442    2.376\n## PA_EDU4      7.3413e-01  2.3401e+00  0.6952    2.047\n## PA_EDU5      1.1317e+00  2.3399e+00  1.1567    2.421\n## PA_EDU6      2.1608e+00  2.2936e+00  2.5298    1.424\n## PA_EDU7      5.5738e+00  2.7555e+00  5.4468    1.094\n## PA_EDU8      2.7883e+00  2.3585e+00  3.3039    1.261\n## PA_EDU9      1.8112e+01  3.1173e+00 12.7768    1.011\n## PART_EDU2    7.4160e+05 1.7988e+276  1.0215    2.673\n## PART_EDU3    1.9113e+06 1.7984e+276  1.0230    2.669\n## PART_EDU4    2.3160e+06 1.7983e+276  1.0233    2.669\n## PART_EDU5    2.0649e+06 1.7983e+276  1.0231    2.669\n## PART_EDU6    5.0312e+06 1.7983e+276  1.0246    2.666\n## PART_EDU7    2.6434e+07 1.7990e+276  1.0272    2.661\n## PART_EDU8    1.5336e+07 1.7984e+276  1.0264    2.662\n## PART_EDU9    5.8537e+06 1.7994e+276  1.0248    2.666</code></pre>\n</div>\n<div id=\"logistic-regression-modeling-of-the-effects-of-the-highest-level-of-education-received-by-each-parent-on-total-household-income\" class=\"section level1\">\n<h1>Logistic Regression Modeling of the Effects of the Highest Level of Education Received by Each Parent on Total Household Income</h1>\n<pre class=\"r\"><code>Income$prob &lt;- predict(fitinc, type = &quot;response&quot;)\ntable(predict = as.numeric(Income$prob &gt; 0.5), truth = Income$recodedincome) %&gt;% \n    addmargins</code></pre>\n<pre><code>##        truth\n## predict   0   1 Sum\n##     0   176  65 241\n##     1    50 120 170\n##     Sum 226 185 411</code></pre>\n<pre class=\"r\"><code>class_diag(Income$prob, truth = Income$recodedincome)</code></pre>\n<pre><code>##         acc      sens      spec       ppv       auc\n## 1 0.7201946 0.6486486 0.7787611 0.7058824 0.7912102</code></pre>\n<pre class=\"r\"><code>logit &lt;- predict(fitinc, response = &quot;logit&quot;)\n\nIncome &lt;- Income %&gt;% drop_na(recodedincome)\nIncome$Income_Category &lt;- ifelse(Income$recodedincome &gt; mean(Income$recodedincome), \n    &quot;above mean&quot;, &quot;below mean&quot;)\n\n\nggplot(Income, aes(x = logit, fill = Income_Category)) + geom_density(alpha = 0.75) + \n    ggtitle(&quot;Prediction Model&quot;)</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-17-1.png\" width=\"768\" style=\"display: block; margin: auto;\" /></p>\n<pre class=\"r\"><code>ROCplot &lt;- ggplot(Income) + geom_roc(aes(d = recodedincome, m = prob), \n    n.cuts = 0) + ggtitle(&quot;Receiver Operating Characteristic Curve&quot;)\nROCplot</code></pre>\n<p><img src=\"/Project2_files/figure-html/unnamed-chunk-17-2.png\" width=\"768\" style=\"display: block; margin: auto;\" /></p>\n<pre class=\"r\"><code>calc_auc(ROCplot)</code></pre>\n<pre><code>##   PANEL group       AUC\n## 1     1    -1 0.7912102</code></pre>\n<p>I was interested in seeing if I could predict whether a family would be expected to have an income above or below average, solely based on the education levels of the mother and father. These factors alone had an accuracy of 0.7201946, a sensitivity of 0.6486486, a specificity of 0.7787611 , a precision of 0.7058824, and an AUC of 0.7912102. The AUC represents the probability that a randomly selected parent with a higher than average income has a higher prediction than a randomly selected parent with a lower than average avaerage. So,with an AUC of 0.7912102, this model is performing well. The intercept shows that the reference group of parents who did not complete junior high have and odds of .0000001319 of making an income above the average. However, when both parents have doctoral degrees, the odds of them making above an average income are 32,627,353 times the odds of parents who did not finish junior high.</p>\n</div>\n<div id=\"cross-validation-on-model-of-the-effects-of-the-highest-level-of-education-received-by-each-parent-on-total-household-income\" class=\"section level1\">\n<h1>Cross Validation on Model of the Effects of the Highest Level of Education Received by Each Parent on Total Household Income</h1>\n<pre class=\"r\"><code>set.seed(1234)\nk = 10\n\ndata1 &lt;- Income[sample(nrow(Income)), ]  #randomly order rows\nfolds &lt;- cut(seq(1:nrow(Income)), breaks = k, labels = F)  #create folds\n\ndiags &lt;- NULL\nfor (i in 1:k) {\n    ## Create training and test sets\n    train &lt;- data1[folds != i, ]\n    test &lt;- data1[folds == i, ]\n    truth &lt;- test$recodedincome\n    \n    ## Train model on training set\n    fit &lt;- glm(recodedincome ~ PA_EDU + PART_EDU, data = train, \n        family = &quot;binomial&quot;)\n    probs &lt;- predict(fit, newdata = test, type = &quot;response&quot;)\n    ## Test model on test set (save all k results)\n    diags &lt;- rbind(diags, class_diag(probs, truth))\n}\n\n\napply(diags, 2, mean)  #average across all k results</code></pre>\n<pre><code>##       acc      sens      spec       ppv       auc \n## 0.7150407 0.6479708 0.7769169 0.7001519 0.7593288</code></pre>\n<p>The logistic regression for the model with out of sample data. The results from this cross validation are lower than the values from above with an accuracy of 0.7150407, a sensitiviy of 0.6479708, a specificity of 0.7769169, a precision of 0.7001519 and an AUC of 0.7593288. This is likely due to the high number of categories that the parents could fall into in education (9 categories each). This model is doing a decent job of catergorizing household incomes as either above or below the mean based on education levels, but in the next step, removing some of these excess variables should help remove the noise that the model was picking up on.</p>\n</div>\n<div id=\"lasso-regression-on-total-household-income\" class=\"section level1\">\n<h1>Lasso Regression on Total Household Income</h1>\n<pre class=\"r\"><code>Income$SCHCOMP &lt;- factor(Income$SCHCOMP)\nIncome$MARSTAT &lt;- factor(Income$MARSTAT)\nIncome$PA_EDU &lt;- factor(Income$PA_EDU)\nIncome$PART_EDU &lt;- factor(Income$PART_EDU)\nIncome$NEIGHCOMP &lt;- factor(Income$NEIGHCOMP)\nIncome$JOBCOMP &lt;- factor(Income$JOBCOMP)\nIncome$LIVEWT &lt;- factor(Income$LIVEWT)\nIncome$CH_GEN &lt;- factor(Income$CH_GEN)\n\n\n\n\nsurveydata &lt;- surveydata %&gt;% drop_na(recodedincome)\nsurveyinc &lt;- surveydata %&gt;% mutate(recodedincome = ifelse(recodedincome &gt; \n    mean(recodedincome), 1, 0))\nsurveyinc &lt;- surveyinc %&gt;% filter(JOBCOMP != 6)\nsurveyinc &lt;- surveyinc %&gt;% drop_na(PA_AGE, LIVEWT, CH_GEN, PA_EDU, \n    PART_EDU, MARSTAT, TOTIVP, CRPR_TOT, RAC_SOC, CUL_SOC, MMRI, \n    vicarious, pdisc, cdisc, TOTRCON, Q232, Q233, totbpi, recodedgpa, \n    NEIGHCOMP, JOBCOMP, SCHCOMP, recodedincome, COUNTRY)\n\n\nset.seed(1234)\nfiteverything &lt;- glm(recodedincome ~ ., data = surveyinc, family = &quot;binomial&quot;)\ny &lt;- as.matrix(surveyinc$recodedincome)  ###save response variable \nx &lt;- model.matrix(fiteverything)  ###save matrix of all predictors (dropping the response variable)\nx &lt;- x[, -1]\n\ncv &lt;- cv.glmnet(x, y, family = &quot;binomial&quot;)\nlasso &lt;- glmnet(x, y, family = &quot;binomial&quot;, lambda = cv$lambda.1se)\ncoef(lasso)</code></pre>\n<pre><code>## 55 x 1 sparse Matrix of class &quot;dgCMatrix&quot;\n##                         s0\n## (Intercept)    -0.94451719\n## PA_GEN          .         \n## PA_AGE          .         \n## LIVEWT2         .         \n## LIVEWT3         .         \n## CH_GEN2         .         \n## CH_GEN3         .         \n## PA_EDU2         .         \n## PA_EDU3        -0.08170020\n## PA_EDU4        -0.61552196\n## PA_EDU5        -0.33657274\n## PA_EDU6         .         \n## PA_EDU7         .         \n## PA_EDU8         .         \n## PA_EDU9         0.57443342\n## PART_EDU2      -0.54135420\n## PART_EDU3      -0.26008525\n## PART_EDU4       .         \n## PART_EDU5       .         \n## PART_EDU6       0.08593753\n## PART_EDU7       0.94153558\n## PART_EDU8       1.01445696\n## PART_EDU9       .         \n## MARSTAT2        1.14048530\n## MARSTAT3        .         \n## MARSTAT4        .         \n## MARSTAT5        .         \n## TOTIVP          .         \n## CRPR_TOT        .         \n## RAC_SOC         .         \n## CUL_SOC         .         \n## MMRI            .         \n## vicarious       .         \n## pdisc           .         \n## cdisc           .         \n## TOTRCON         .         \n## Q232            .         \n## Q233            .         \n## totbpi          .         \n## NEIGHCOMP2      .         \n## NEIGHCOMP3      .         \n## NEIGHCOMP4      .         \n## NEIGHCOMP5      .         \n## JOBCOMP2        .         \n## JOBCOMP3        .         \n## JOBCOMP4        .         \n## JOBCOMP5        .         \n## SCHCOMP2        .         \n## SCHCOMP3        .         \n## SCHCOMP4        .         \n## SCHCOMP5        .         \n## recodedgpa      .         \n## COUNTRY         .         \n## cdisc_centered  .         \n## pdisc_centered  .</code></pre>\n<pre class=\"r\"><code>surveyinc$PA_EDU3 &lt;- ifelse(surveyinc$PA_EDU == &quot;3&quot;, 1, 0)\nsurveyinc$PA_EDU4 &lt;- ifelse(surveyinc$PA_EDU == &quot;4&quot;, 1, 0)\nsurveyinc$PA_EDU5 &lt;- ifelse(surveyinc$PA_EDU == &quot;5&quot;, 1, 0)\nsurveyinc$PA_EDU9 &lt;- ifelse(surveyinc$PA_EDU == &quot;9&quot;, 1, 0)\n\nsurveyinc$PART_EDU2 &lt;- ifelse(surveyinc$PART_EDU == &quot;2&quot;, 1, 0)\nsurveyinc$PART_EDU3 &lt;- ifelse(surveyinc$PART_EDU == &quot;3&quot;, 1, 0)\nsurveyinc$PART_EDU7 &lt;- ifelse(surveyinc$PART_EDU == &quot;7&quot;, 1, 0)\nsurveyinc$PART_EDU8 &lt;- ifelse(surveyinc$PART_EDU == &quot;8&quot;, 1, 0)\nsurveyinc$PART_EDU6 &lt;- ifelse(surveyinc$PART_EDU == &quot;6&quot;, 1, 0)\n\nsurveyinc$MARSTAT2 &lt;- ifelse(surveyinc$MARSTAT == &quot;2&quot;, 1, 0)\n\n\nset.seed(1234)\nk = 10\n\ndata1 &lt;- surveyinc[sample(nrow(surveyinc)), ]  #randomly order rows\nfolds &lt;- cut(seq(1:nrow(surveyinc)), breaks = k, labels = F)  #create folds\n\ndiags &lt;- NULL\nfor (i in 1:k) {\n    ## Create training and test sets\n    train &lt;- data1[folds != i, ]\n    test &lt;- data1[folds == i, ]\n    truth &lt;- test$recodedincome\n    \n    ## Train model on training set\n    fit &lt;- glm(recodedincome ~ PA_EDU3 + PA_EDU4 + PA_EDU5 + \n        PA_EDU9 + PART_EDU2 + PART_EDU3 + PART_EDU7 + PART_EDU8 + \n        PART_EDU6 + MARSTAT2, data = train, family = &quot;binomial&quot;)\n    probs &lt;- predict(fit, newdata = test, type = &quot;response&quot;)\n    ## Test model on test set (save all k results)\n    diags &lt;- rbind(diags, class_diag(probs, truth))\n}\n\n\napply(diags, 2, mean)  #average across all k results</code></pre>\n<pre><code>##       acc      sens      spec       ppv       auc \n## 0.7501681 0.7521280 0.7519153 0.7350177 0.8256999</code></pre>\n<p>By running the lasso regression, the model is better overall. The accuracy is 0.7501681, the sensitivity is 0.7521280, the specificity is 0.7519153, the precision is 0.7350177, and the AUC is now 0.8256999. The only variables with non-zero coefficients for this lasso regression were: if the parent is currently married, if the parent graduated HS, if the parent dropped out of college before an associate’s degree, if the parent obtained their associate’s degree, if the parent obtained a doctoral degree, if the partner dropped out of HS, if the partner finished HS, if the partner obtained their bachelor’s degree, some graduate school, and obtained their master’s degree. One point of interest is that for the PA_EDU, obtaining a bachelor’s degree was not significant when compared to the others and for the PART_EDU, obtaining a bachelor’s degree was significant, but its coefficient was still very small. This emphasizes how obtaining a bachelor’s degree is no longer a super strong indicator of income, and instead in most cases it takes graduate level education to achieve higher levels of income.</p>\n</div>\n<div id=\"lasso-regression-on-gpa\" class=\"section level1\">\n<h1>Lasso Regression on GPA</h1>\n<pre class=\"r\"><code>surveygpa &lt;- surveydata %&gt;% drop_na(recodedgpa)\nsurveygpa &lt;- surveygpa %&gt;% mutate(recodedgpa = ifelse(recodedgpa &gt;= \n    mean(recodedgpa), 1, 0))\n\n\nsurveygpa &lt;- surveygpa %&gt;% drop_na(PA_AGE, LIVEWT, CH_GEN, PA_EDU, \n    PART_EDU, MARSTAT, TOTIVP, CRPR_TOT, RAC_SOC, CUL_SOC, MMRI, \n    vicarious, pdisc, cdisc, TOTRCON, Q232, Q233, totbpi, recodedgpa, \n    NEIGHCOMP, JOBCOMP, SCHCOMP, recodedincome, COUNTRY)\n\n\nset.seed(348)\nfiteverything &lt;- glm(recodedgpa ~ ., data = surveygpa, family = &quot;binomial&quot;)\ny &lt;- as.matrix(surveygpa$recodedgpa)  ###save response variable \nx &lt;- model.matrix(fiteverything)  ###save matrix of all predictors (dropping the response variable)\nx &lt;- x[, -1]\n\ncv &lt;- cv.glmnet(x, y, family = &quot;binomial&quot;)\nlasso &lt;- glmnet(x, y, family = &quot;binomial&quot;, lambda = cv$lambda.1se)\ncoef(lasso)</code></pre>\n<pre><code>## 56 x 1 sparse Matrix of class &quot;dgCMatrix&quot;\n##                         s0\n## (Intercept)     0.14529496\n## PA_GEN          .         \n## PA_AGE          .         \n## LIVEWT2         .         \n## LIVEWT3         .         \n## CH_GEN2         .         \n## CH_GEN3         .         \n## PA_EDU2         .         \n## PA_EDU3         .         \n## PA_EDU4         .         \n## PA_EDU5         .         \n## PA_EDU6         .         \n## PA_EDU7         .         \n## PA_EDU8         .         \n## PA_EDU9         .         \n## PART_EDU2       .         \n## PART_EDU3       .         \n## PART_EDU4       .         \n## PART_EDU5       .         \n## PART_EDU6       .         \n## PART_EDU7       .         \n## PART_EDU8       .         \n## PART_EDU9       .         \n## MARSTAT2        .         \n## MARSTAT3        .         \n## MARSTAT4        .         \n## MARSTAT5        .         \n## TOTIVP          .         \n## CRPR_TOT        .         \n## RAC_SOC         .         \n## CUL_SOC         .         \n## MMRI            .         \n## vicarious       .         \n## pdisc           .         \n## cdisc           .         \n## TOTRCON         .         \n## Q232            .         \n## Q233            .         \n## totbpi         -0.02112477\n## NEIGHCOMP2      .         \n## NEIGHCOMP3      .         \n## NEIGHCOMP4      .         \n## NEIGHCOMP5      .         \n## JOBCOMP2        .         \n## JOBCOMP3        .         \n## JOBCOMP4        .         \n## JOBCOMP5        .         \n## JOBCOMP6        .         \n## SCHCOMP2        .         \n## SCHCOMP3        .         \n## SCHCOMP4        .         \n## SCHCOMP5        .         \n## recodedincome   .         \n## COUNTRY         .         \n## cdisc_centered  .         \n## pdisc_centered  .</code></pre>\n<p>One last thing that I wanted to illustrate is the importance of the bpi (behavior problem index). I did, however, end up running a lasso regression just to see what variables are significant predictors of a child’s GPA. It turns out that bpi was the only important predictor. This was similar to the result in the original MANOVA where the total bpi is the only numeric variable that was significantly different among GPA groupings. A child’s bpi score was modeled extensively above, and this lasso regression reveals just how influential it can be on a child’s GPA compared to not just the numeric variables but also the categorical variables. Since the bpi score targets topics such as depression, anxiety, and sociality, these results emphasize how important mental health is to a child’s academic performance.</p>\n<pre><code>## R version 3.6.1 (2019-07-05)\n## Platform: x86_64-apple-darwin15.6.0 (64-bit)\n## Running under: macOS Catalina 10.15.1\n## \n## Matrix products: default\n## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib\n## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib\n## \n## locale:\n## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n## \n## attached base packages:\n## [1] stats     graphics  grDevices utils     datasets  methods   base     \n## \n## other attached packages:\n##  [1] glmnet_3.0-1     Matrix_1.2-17    sandwich_2.5-1   mvnormtest_0.1-9\n##  [5] plotROC_2.2.1    lmtest_0.9-37    zoo_1.8-6        MASS_7.3-51.4   \n##  [9] dbplyr_1.4.2     forcats_0.4.0    stringr_1.4.0    dplyr_0.8.3     \n## [13] purrr_0.3.2      readr_1.3.1      tidyr_1.0.0      tibble_2.1.3    \n## [17] ggplot2_3.2.1    tidyverse_1.2.1  knitr_1.25      \n## \n## loaded via a namespace (and not attached):\n##  [1] Rcpp_1.0.2       lubridate_1.7.4  lattice_0.20-38  foreach_1.4.7   \n##  [5] assertthat_0.2.1 zeallot_0.1.0    digest_0.6.21    utf8_1.1.4      \n##  [9] R6_2.4.0         cellranger_1.1.0 plyr_1.8.4       backports_1.1.5 \n## [13] evaluate_0.14    httr_1.4.1       blogdown_0.17    pillar_1.4.2    \n## [17] rlang_0.4.0      lazyeval_0.2.2   readxl_1.3.1     rstudioapi_0.10 \n## [21] rmarkdown_1.18   labeling_0.3     munsell_0.5.0    broom_0.5.2     \n## [25] compiler_3.6.1   modelr_0.1.5     xfun_0.10        pkgconfig_2.0.3 \n## [29] shape_1.4.4      htmltools_0.4.0  tidyselect_0.2.5 bookdown_0.16   \n## [33] codetools_0.2-16 fansi_0.4.0      crayon_1.3.4     withr_2.1.2     \n## [37] grid_3.6.1       nlme_3.1-140     jsonlite_1.6     gtable_0.3.0    \n## [41] lifecycle_0.1.0  DBI_1.0.0        magrittr_1.5     formatR_1.7     \n## [45] scales_1.0.0     cli_1.1.0        stringi_1.4.3    xml2_1.2.2      \n## [49] ellipsis_0.3.0   generics_0.0.2   vctrs_0.2.0      iterators_1.0.12\n## [53] tools_3.6.1      glue_1.3.1       hms_0.5.1        yaml_2.2.0      \n## [57] colorspace_1.4-1 rvest_0.3.4      haven_2.1.1</code></pre>\n<pre><code>## [1] &quot;2020-01-11 17:40:56 CST&quot;</code></pre>\n<pre><code>##                                                                                            sysname \n##                                                                                           &quot;Darwin&quot; \n##                                                                                            release \n##                                                                                           &quot;19.0.0&quot; \n##                                                                                            version \n## &quot;Darwin Kernel Version 19.0.0: Thu Oct 17 16:17:15 PDT 2019; root:xnu-6153.41.3~29/RELEASE_X86_64&quot; \n##                                                                                           nodename \n##                                                                          &quot;Ninas-MacBook-Air.local&quot; \n##                                                                                            machine \n##                                                                                           &quot;x86_64&quot; \n##                                                                                              login \n##                                                                                             &quot;root&quot; \n##                                                                                               user \n##                                                                                       &quot;ninaflores&quot; \n##                                                                                     effective_user \n##                                                                                       &quot;ninaflores&quot;</code></pre>\n</div>\n",
    "created" : 1578783431084.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1865216746",
    "id" : "CF132B2C",
    "lastKnownWriteTime" : 1578786057,
    "last_content_update" : 1578786057,
    "path" : "~/Desktop/website/content/Project2.html",
    "project_path" : "content/Project2.html",
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "html"
}