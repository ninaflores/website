"0","class_diag<-function(probs,truth){"
"0","  "
"0","  tab<-table(factor(probs>.5,levels=c(""FALSE"",""TRUE"")),truth)"
"0","  acc=sum(diag(tab))/sum(tab)"
"0","  sens=tab[2,2]/colSums(tab)[2]"
"0","  spec=tab[1,1]/colSums(tab)[1]"
"0","  ppv=tab[2,2]/rowSums(tab)[2]"
"0","  if(is.numeric(truth)==FALSE & is.logical(truth)==FALSE) truth<-as.numeric(truth)-1"
"0","  "
"0","  #CALCULATE EXACT AUC"
"0","  ord<-order(probs, decreasing=TRUE)"
"0","  probs <- probs[ord]; truth <- truth[ord]"
"0","  "
"0","  TPR=cumsum(truth)/max(1,sum(truth)) "
"0","  FPR=cumsum(!truth)/max(1,sum(!truth))"
"0","  "
"0","  dup<-c(probs[-1]>=probs[-length(probs)], FALSE)"
"0","  TPR<-c(0,TPR[!dup],1); FPR<-c(0,FPR[!dup],1)"
"0","  "
"0","  n <- length(TPR)"
"0","  auc<- sum( ((TPR[-1]+TPR[-n])/2) * (FPR[-1]-FPR[-n]) )"
"0","  data.frame(acc,sens,spec,ppv,auc)"
"0","}"
"0","surveybpi$prob <- predict(fitbpi, type = ""response"")"
"0","table(predict = as.numeric(surveybpi$prob > 0.5), truth = surveybpi$totbpi) %>%"
"0","  addmargins"
"1","       truth
"
"1","predict"
"1","   0"
"1","   1"
"1"," Sum"
"1","
    0  "
"1"," 275"
"1","  98"
"1"," 373"
"1","
    1  "
"1","  39"
"1","  76"
"1"," 115"
"1","
    Sum"
"1"," 314"
"1"," 174"
"1"," 488"
"1","
"
"0","class_diag(surveybpi$prob, truth = surveybpi$totbpi)"
"1"," "
"1","       acc"
"1","      sens"
"1","      spec"
"1","       ppv"
"1","       auc"
"1","
1"
"1"," 0.7192623"
"1"," 0.4367816"
"1"," 0.8757962"
"1"," 0.6608696"
"1"," 0.7630225"
"1","
"
